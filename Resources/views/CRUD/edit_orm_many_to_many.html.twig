{#

This file is part of the Sonata package.

(c) Thomas Rabaix <thomas.rabaix@sonata-project.org>

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.

#}

{% if sonata_admin.field_description.associationadmin %}
    <div id="field_container_{{ id }}" class="field-container">
        <span id="field_widget_{{ id }}" >
            {{ form_widget(form) }}
        </span>

        <span id="field_actions_{{ id }}" class="field-actions btn-group">
            {% if sonata_admin.field_description.associationadmin.hasRoute('create') and sonata_admin.field_description.associationadmin.isGranted('CREATE') and btn_add %}
                {% if sonata_admin.field_description.associationadmin.subclasses is empty %}
                    <a
                        href="{{ sonata_admin.field_description.associationadmin.generateUrl('create', sonata_admin.field_description.getOption('link_parameters', {})) }}"
                        onclick="return start_field_dialog_form_add_{{ id }}(this);"
                        class="btn sonata-ba-action"
                        title="{{ btn_add|trans({}, btn_catalogue) }}"
                        >
                        <i class="icon-plus"></i>
                        {{ btn_add|trans({}, btn_catalogue) }}
                    </a>
                {% else %}
                    <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="icon-plus"></i>
                        {{ btn_add|trans({}, btn_catalogue) }}
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        {% for subclass in sonata_admin.field_description.associationadmin.subclasses|keys %}
                            <li>
                                <a 
                                    onclick="return start_field_dialog_form_add_{{ id }}(this);"
                                    accesskey=""
                                    title="{{ subclass|trans({}, sonata_admin.field_description.associationadmin.translationdomain) }}"
                                    href="{{ sonata_admin.field_description.associationadmin.generateUrl('create', {'subclass': subclass}) }}">{{ subclass|trans({}, sonata_admin.field_description.associationadmin.translationdomain) }}</a>
                            </li>
                        {% endfor %}
                    </ul>
                {% endif %}
            {% endif %}
        </span>

        <div style="display: none" id="field_dialog_{{ id }}">
        </div>
    </div>

    {% include 'SonataDoctrineORMAdminBundle:CRUD:edit_orm_many_association_script.html.twig' %}
{% endif %}
